<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tutorial: creating a document from a table • rspacer</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial: creating a document from a table">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rspacer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/rspacer.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/create_document_from_excel.html">Tutorial: creating a document from a table</a></li>
    <li><a class="dropdown-item" href="../articles/create_document_from_html.html">Tutorial: creating a document from html</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/burgerga/rspacer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Tutorial: creating a document from a table</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/burgerga/rspacer/blob/main/vignettes/articles/create_document_from_excel.Rmd" class="external-link"><code>vignettes/articles/create_document_from_excel.Rmd</code></a></small>
      <div class="d-none name"><code>create_document_from_excel.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="before-you-start">Before you start<a class="anchor" aria-label="anchor" href="#before-you-start"></a>
</h2>
<p>In this tutorial, we describe how to create an RSpace structured
document from a delimited file format, such as Excel, TSV or CSV. We
advice you to read <code><a href="../articles/rspacer.html">vignette("rspacer")</a></code> to make sure that
you are ready to use this upload document. You need to install rspacer
and set up your API url and API key before the start of this
tutorial.</p>
</div>
<div class="section level2">
<h2 id="load-r-libraries">Load R libraries<a class="anchor" aria-label="anchor" href="#load-r-libraries"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/burgerga/rspacer" class="external-link">rspacer</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="check-if-the-api-is-available">Check if the API is available<a class="anchor" aria-label="anchor" href="#check-if-the-api-is-available"></a>
</h2>
<p>This code checks if the API is available. The API status should be
OK.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/api_status.html">api_status</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $message</span></span>
<span><span class="co">## [1] "OK"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $rspaceVersion</span></span>
<span><span class="co">## [1] "1.109.1"</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">message</span> <span class="op">==</span> <span class="st">"OK"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-a-structured-document-in-rspace">Create a structured document in RSpace<a class="anchor" aria-label="anchor" href="#create-a-structured-document-in-rspace"></a>
</h2>
<p>Create a Template from a Form with four text Fields named “Title”,
“Date”, “Main part” and “Conclusion”. Write down the unique Structured
Document identifier, you will need it later. For us, this identifier was
<code>SD377682</code>. Instructions to design a Template in RSpace can
be found <a href="https://documentation.researchspace.com/article/wxfk9gf0a0-templates" class="external-link">here</a>.</p>
</div>
<div class="section level2">
<h2 id="create-a-small-example-document">Create a small example document<a class="anchor" aria-label="anchor" href="#create-a-small-example-document"></a>
</h2>
<p>Open Excel and create a csv file or run the code chunk below to
create a small example file. It should have two columns. The first one
should have all fields exactly the same as the template. The second
column should have the content of each field in the correct format. If
you use Excel, make sure that dates are saved as a string in the format
dd-mm-yyyy.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">file_name</span> <span class="op">&lt;-</span> <span class="st">"Template_example.csv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Template_example.csv"</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Title"</span>, <span class="st">"Date"</span>, <span class="st">"Main part"</span>, <span class="st">"Conclusion"</span><span class="op">)</span>,</span>
<span>  content <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"example title"</span>, <span class="st">"23-12-2024"</span>, <span class="st">"This is example text."</span>,</span>
<span>              <span class="st">"ready for uploading."</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">write_csv</span><span class="op">(</span><span class="va">file_name</span>, col_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="specify-the-file-name-of-the-file-to-upload">Specify the file name of the file to upload<a class="anchor" aria-label="anchor" href="#specify-the-file-name-of-the-file-to-upload"></a>
</h2>
<p>You need to define which file you want to upload. In this tutorial,
we want to create a structured document from the file
<code>Template_example.csv</code> that we created before. The path is
defined in the <code>file_name</code> variable in the previous chunk.
Here, we check that the file exists before we start the upload. We
recommend to work with relative paths from within an R project, for
example using the <a href="https://here.r-lib.org/" class="external-link"><code>here</code>
package</a>. If this is not what you want, you need to specify the
absolute file path.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">file_name</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="upload-the-file">Upload the file<a class="anchor" aria-label="anchor" href="#upload-the-file"></a>
</h3>
<p>To upload the document to the API inbox, this code chunk is
sufficient and returns the created document. It creates a document from
your Template_example.csv. The function works with CSV, TSV and XLSX
file formats. Make sure that the template_id is the identifier of the
template that you previously made in RSpace.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/document_create_from_excel.html">document_create_from_excel</a></span><span class="op">(</span></span>
<span>    path <span class="op">=</span> <span class="va">file_name</span>,</span>
<span>    template_id <span class="op">=</span> <span class="st">"SD377682"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Document created: &lt;https://leiden.researchspace.com/globalId/SD409944&gt;</span></span></code></pre>
<p>The function <code>document_create_from_excel</code> has more
parameters, for example to upload the document to the specified notebook
or folder (click the function above to learn more).</p>
<p>How to find the values for these parameters? Browse your RSpace
folders using <code><a href="../reference/folder_tree.html">folder_tree()</a></code> and use either the
<code>id</code> or the <code>globalID</code>. Folder identifiers start
with <code>FL</code>, notebook identifiers start with <code>NB</code>,
structured document identifiers start with <code>SD</code>. For
example:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/folder_tree.html">folder_tree</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 8 × 9</span></span>
<span><span class="co">##       id globalId name                      created                  lastModified             parentFolderId type   `_links`   owner            </span></span>
<span><span class="co">##    &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;                     &lt;chr&gt;                    &lt;chr&gt;                             &lt;int&gt; &lt;chr&gt;  &lt;list&gt;     &lt;list&gt;           </span></span>
<span><span class="co">## 1 368771 FL368771 i001_PhD_Hanneke          2024-04-12T11:37:28.954Z 2024-04-12T11:37:28.954Z           2790 FOLDER &lt;list [1]&gt; &lt;named list [10]&gt;</span></span>
<span><span class="co">## 2 366764 FL366764 Api Inbox                 2024-03-28T11:18:35.212Z 2024-03-28T11:18:35.212Z           2790 FOLDER &lt;list [1]&gt; &lt;named list [10]&gt;</span></span>
<span><span class="co">## 3 239405 FL239405 Ontologies                2023-04-17T12:54:17.626Z 2023-04-17T12:54:17.626Z           2790 FOLDER &lt;list [1]&gt; &lt;named list [10]&gt;</span></span>
<span><span class="co">## 4  37108 FL37108  Migrated_31-03_leegwaterh 2023-03-31T19:46:29.529Z 2023-03-31T19:46:29.529Z           2790 FOLDER &lt;list [1]&gt; &lt;named list [10]&gt;</span></span>
<span><span class="co">## 5  14411 FL14411  Testing_Rspace_folder     2023-01-12T21:07:31.965Z 2023-01-12T21:07:31.965Z           2790 FOLDER &lt;list [1]&gt; &lt;named list [10]&gt;</span></span>
<span><span class="co">## 6   2810 FL2810   Templates                 2022-12-22T12:19:03.336Z 2022-12-22T12:19:03.336Z           2790 FOLDER &lt;list [1]&gt; &lt;named list [10]&gt;</span></span>
<span><span class="co">## 7   2796 GF2796   Gallery                   2022-12-22T12:19:03.285Z 2022-12-22T12:19:03.285Z           2790 FOLDER &lt;list [1]&gt; &lt;named list [10]&gt;</span></span>
<span><span class="co">## 8   2791 FL2791   Shared                    2022-12-22T12:19:03.267Z 2022-12-22T12:19:03.267Z           2790 FOLDER &lt;list [1]&gt; &lt;named list [10]&gt;</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/folder_tree.html">folder_tree</a></span><span class="op">(</span><span class="st">"FL409926"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 3 × 9</span></span>
<span><span class="co">##       id globalId name                      created                  lastModified             parentFolderId type     `_links`   owner            </span></span>
<span><span class="co">##    &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;                     &lt;chr&gt;                    &lt;chr&gt;                             &lt;int&gt; &lt;chr&gt;    &lt;list&gt;     &lt;list&gt;           </span></span>
<span><span class="co">## 2 409929 SD409929 a002_normalize_lipidomics 2025-04-24T10:01:59.773Z 2025-04-24T10:02:14.439Z         409926 DOCUMENT &lt;list [1]&gt; &lt;named list [10]&gt;</span></span>
<span><span class="co">## 3 409928 SD409928 a001_preprocess_data      2025-04-24T10:01:34.585Z 2025-04-24T10:01:52.594Z         409926 DOCUMENT &lt;list [1]&gt; &lt;named list [10]&gt;</span></span></code></pre>
<p>Of course you can also find these by going to the web interface of
your RSpace instance. You can also tag your documents using a
<code>tags</code> vector, for example a status like “finished” or “in
progress” or “failed”. If you want to upload attachments to a field, use
the <code>attachments</code> argument. Files will be added in the number
of the field as an attachment. You can optionally replace an existing
Document by specifying an <code>existing_file_id</code>. Use this only
if a file needs to be replaced instead of created.</p>
<p>In this example we add a Quarto code file and a HTML file
Template_example.html as an attachment to the field with number 4. We
also place the file in a specific folder, and add the “tutorial”
tag.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">attachment_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"Template_example.html"</span>, package <span class="op">=</span> <span class="st">"rspacer"</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">matching_code_file</span> <span class="op">&lt;-</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/path_file.html" class="external-link">path_ext_set</a></span><span class="op">(</span><span class="va">attachment_file</span>, <span class="st">".qmd"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## C:/Users/leegwaterh/Documents/R/win-library/4.4/rspacer/Template_example.qmd</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/document_create_from_excel.html">document_create_from_excel</a></span><span class="op">(</span></span>
<span>  path <span class="op">=</span> <span class="va">file_name</span>,</span>
<span>  template_id <span class="op">=</span> <span class="st">"SD377682"</span>,</span>
<span>  folder_id <span class="op">=</span> <span class="st">"FL409926"</span>,</span>
<span>  tags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tutorial"</span><span class="op">)</span>,</span>
<span>  attachments <span class="op">=</span> <span class="fu">tibble</span><span class="op">(</span>field <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">attachment_file</span>, <span class="va">matching_code_file</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Rows: 4 Columns: 2</span></span>
<span><span class="co">## ── Column specification ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">## Delimiter: ","</span></span>
<span><span class="co">## chr (2): name, content</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="co">## File uploaded to &lt;https://leiden.researchspace.com/globalId/GL409946&gt;</span></span>
<span><span class="co">## File uploaded to &lt;https://leiden.researchspace.com/globalId/GL409947&gt;</span></span>
<span><span class="co">## Document created: &lt;https://leiden.researchspace.com/globalId/SD409948&gt;</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gerhard Burger, Hanneke Leegwater.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
